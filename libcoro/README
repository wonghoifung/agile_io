A brand new version of coroutine implementation
